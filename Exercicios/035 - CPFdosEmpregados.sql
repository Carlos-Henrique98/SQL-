CREATE DATABASE CPFdosEmpregados;

USE CPFdosEmpregados;

CREATE TABLE TEmpregados (
IdCPF VARCHAR(15) PRIMARY KEY,
NomeE VARCHAR(60) NOT NULL,
Salario DECIMAL(6,2) NOT NULL,
CPF_Supervisor VARCHAR(15) NOT NULL,
NumeroD INT NOT NULL
);
GO

CREATE TABLE Departamentos(
NumeroD INT PRIMARY KEY IDENTITY(1010,10),
NomeD VARCHAR(60) NOT NULL,
GerenteCPF VARCHAR(15) NOT NULL
);
GO

CREATE TABLE Trabalha(
NumeroP INT NOT NULL,
IdCPF VARCHAR(15) FOREIGN KEY REFERENCES TEmpregados (IdCPF)
);
GO

CREATE TABLE Projetos(
NumeroP INT PRIMARY KEY IDENTITY(2010,10),
NomeP VARCHAR(45) NOT NULL,
NumeroD INT FOREIGN KEY REFERENCES Departamentos (NumeroD)
);
GO

INSERT INTO TEmpregados VALUES ('049382234322','João Silva',2350,2434332222,1010);
INSERT INTO TEmpregados VALUES ('586733922290','Mario Silveira',3500,2434332222,1010);
INSERT INTO TEmpregados VALUES ('2434332222','Aline Barros',2350,' ', 1010);
INSERT INTO TEmpregados VALUES ('1733332162','Tulio Vidal',8350,' ',1020);
INSERT INTO TEmpregados VALUES ('4244435272','Juliana Rodrigues', 3310,' ',1020);
INSERT INTO TEmpregados VALUES ('1014332672','Natalia Marques',2900,' ',1010);

INSERT INTO Departamentos VALUES ('Pesquisa', 049382234322);
INSERT INTO Departamentos VALUES ('Ensino', 2434332222);

INSERT INTO Projetos VALUES ('Alpha', 1010);
INSERT INTO Projetos VALUES ('Beta', 1020);

INSERT INTO Trabalha VALUES (2010,'4938223422');
INSERT INTO Trabalha VALUES (2020, '586733922290');
INSERT INTO Trabalha VALUES (2020,'49382234221');

DROP TABLE Trabalha;
DROP TABLE Projetos;
DROP TABLE Departamentos;
DROP TABLE TEmpregados;

SELECT * FROM Trabalha;
SELECT * FROM Projetos;
SELECT * FROM Departamentos;
SELECT * FROM TEmpregados;

SELECT E.IdCPF AS CPF, E.NomeE AS Nome, D.NomeD AS Departamento FROM Departamentos D 
INNER JOIN TEmpregados E ON D.NumeroD = E.NumeroD
LEFT JOIN Trabalha T ON T.IdCPF = E.IdCPF
LEFT JOIN Projetos P ON T.NumeroP = P.NumeroP
WHERE P.NumeroP IS NULL
ORDER BY E.IdCPF